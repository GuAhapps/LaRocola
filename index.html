<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-t" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#FBB040">
    <title>La Rocola - Sáenz Peña</title>
    <link rel="icon" href="https://archive.org/download/favicom-04/favicom-04.png" type="image/png">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              'brand-bg': '#EAD9BB',
              'brand-header': '#FBB040',
              'brand-card': '#F5EFE6',
              'brand-text': '#4A2C2A',
              'brand-text-light': '#6D4C41',
              'brand-accent': '#BF5700',
            },
            keyframes: {
              'slide-in-from-bottom': {
                '0%': { transform: 'translateY(100%)', opacity: '0' },
                '100%': { transform: 'translateY(0)', opacity: '1' },
              },
            },
            animation: {
                'slide-in-from-bottom': 'slide-in-from-bottom 0.3s ease-out forwards',
            }
          }
        }
      }
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
      body {
        font-family: 'Roboto', sans-serif;
      }
      /* Hide scrollbar for Chrome, Safari and Opera */
      .no-scrollbar::-webkit-scrollbar {
        display: none;
      }
      /* Hide scrollbar for IE, Edge and Firefox */
      .no-scrollbar {
        -ms-overflow-style: none;  /* IE and Edge */
        scrollbar-width: none;  /* Firefox */
      }
    </style>
    <!-- React and Babel for in-browser transpilation -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.1.0",
    "react-dom/": "https://esm.sh/react-dom@^19.1.0/",
    "react/": "https://esm.sh/react@^19.1.0/"
  }
}
</script>
</head>
  <body class="bg-brand-bg">
    <div id="root"></div>
    <script type="text/babel">
      // React Hooks
      const { useState, useEffect, useRef, useCallback, useMemo } = React;

      // --- HELPERS ---
      const formatPrice = (price) => {
        return new Intl.NumberFormat('es-AR', {
          style: 'currency',
          currency: 'ARS',
          minimumFractionDigits: 0,
          maximumFractionDigits: 0,
        }).format(price);
      };

      const getStoreStatus = (shift) => {
        const now = new Date();
        // Argentina is UTC-3. No DST.
        const nowUTC = now.getTime() + (now.getTimezoneOffset() * 60000);
        const nowArgentina = new Date(nowUTC - (3 * 3600 * 1000));

        const hours = nowArgentina.getHours();
        const minutes = nowArgentina.getMinutes();
        const currentTime = hours + minutes / 60;

        const middayOpen = 11.5; // 11:30 hs
        const middayClose = 14.5; // 14:30 hs

        const nightOpen = 19.5; // 19:30 hs
        const nightClose = 1.5; // 01:30 hs

        let isOpen = false;
        let message = '';

        if (shift === 'midday') {
            isOpen = currentTime >= middayOpen && currentTime < middayClose;
            message = isOpen ? '¡Estamos abiertos para almuerzos!' : 'Cerrado. Horario de almuerzo: 11:30 a 14:30 hs.';
        } else if (shift === 'night') {
            isOpen = currentTime >= nightOpen || currentTime < nightClose;
            message = isOpen ? '¡Estamos abiertos para la cena!' : 'Cerrado. Horario de cena: 19:30 a 01:30 hs.';
        }

        return { isOpen, message };
      };


      // --- DATA ---
      const Category = {
        Pizzas: 'Pizzas',
        Hamburguesas: 'Hamburguesas',
        Empanadas: 'Empanadas',
        Promos: 'Promos',
        Sanguches: 'Sánguches',
        Pastas: 'Pastas',
        ComidasAlPlato: 'Comidas al Plato',
        Guarniciones: 'Guarniciones',
        Bebidas: 'Bebidas',
      };

      const pastaImage = 'https://images.unsplash.com/photo-1551183053-bf91a1d81141?q=80&w=1974&auto=format&fit=crop';
      const platoImage = 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSCFPRRRU9eQwzJIL49rm_ouCPQdfiupCSSyMalR9Lmm-C04Gy09ag96E2wLTdZ3fe98SQ&usqp=CAU';
      const sangucheImage = 'https://media-cdn.tripadvisor.com/media/photo-s/08/af/fe/20/definitivamente-los-sanguches.jpg';
      const empanadaImage = 'https://cocinerosargentinos.com/content/recipes/original/recipes.12223.jpeg';
      const pizzaImage = 'https://breaders.com.ar/web/wp-content/uploads/2022/01/pizzas-napolitana-1200x900.jpg';
      const burgerImage = 'https://images.unsplash.com/photo-1571091718767-18b5b1457add?q=80&w=2072&auto=format&fit=crop';
      const friesImage = 'https://images.unsplash.com/photo-1541592106381-b31e9677c0e5?q=80&w=2070&auto=format&fit=crop';

      const menuItems = [
        // === MEDIODÍA ===
        // Pastas
        { id: 'p1', name: 'Tallarines', price: 6500, category: Category.Pastas, shift: 'midday', imageUrls: [pastaImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'p2', name: 'Ravioles', price: 7000, category: Category.Pastas, shift: 'midday', imageUrls: [pastaImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'p3', name: 'Ñoquis', price: 6500, category: Category.Pastas, shift: 'midday', imageUrls: [pastaImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'p4', name: 'Arroz', price: 4500, category: Category.Pastas, shift: 'midday', imageUrls: [pastaImage], description: '', ingredients: [], prepTime: 'N/A' },
        // Comidas al Plato
        { id: 'cp1', name: 'Milanesas de Carne con Puré de Papas', price: 9000, category: Category.ComidasAlPlato, shift: 'midday', imageUrls: [platoImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'cp2', name: 'Milanesas de Carne con Papas Fritas', price: 9000, category: Category.ComidasAlPlato, shift: 'midday', imageUrls: [platoImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'cp3', name: 'Milanesas Napolitana de Carne con Puré de Papas', price: 12000, category: Category.ComidasAlPlato, shift: 'midday', imageUrls: [platoImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'cp4', name: 'Milanesas Napolitana de Carne con Papas Fritas', price: 12000, category: Category.ComidasAlPlato, shift: 'midday', imageUrls: [platoImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'cp5', name: 'Milanesas de Carne con Huevos frito y Puré de Papas', price: 12000, category: Category.ComidasAlPlato, shift: 'midday', imageUrls: [platoImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'cp6', name: 'Milanesas de Carne con Huevos y Papas Fritas', price: 12000, category: Category.ComidasAlPlato, shift: 'midday', imageUrls: [platoImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'cp7', name: 'Milanesas de Pollo con Puré de Papas', price: 8000, category: Category.ComidasAlPlato, shift: 'midday', imageUrls: [platoImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'cp8', name: 'Milanesas de Pollo con Papas Fritas', price: 8000, category: Category.ComidasAlPlato, shift: 'midday', imageUrls: [platoImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'cp9', name: 'Milanesas Napolitana de Pollo con Puré de Papas', price: 10000, category: Category.ComidasAlPlato, shift: 'midday', imageUrls: [platoImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'cp10', name: 'Milanesas Napolitana de Pollo con Papas Fritas', price: 10000, category: Category.ComidasAlPlato, shift: 'midday', imageUrls: [platoImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'cp11', name: 'Milanesas de Pollo con Huevos frito y Puré de Papas', price: 10000, category: Category.ComidasAlPlato, shift: 'midday', imageUrls: [platoImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'cp12', name: 'Milanesas de Pollo con Huevos y Papas Fritas', price: 10000, category: Category.ComidasAlPlato, shift: 'midday', imageUrls: [platoImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'cp13', name: 'Marineras con Puré de Papas', price: 9000, category: Category.ComidasAlPlato, shift: 'midday', imageUrls: [platoImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'cp14', name: 'Marineras con Papas Fritas', price: 9000, category: Category.ComidasAlPlato, shift: 'midday', imageUrls: [platoImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'cp15', name: 'Costeleta de Carne con Puré de Papas', price: 9000, category: Category.ComidasAlPlato, shift: 'midday', imageUrls: [platoImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'cp16', name: 'Costeleta de Carne con Papas Fritas', price: 9000, category: Category.ComidasAlPlato, shift: 'midday', imageUrls: [platoImage], description: '', ingredients: [], prepTime: 'N/A' },
        // Sánguches
        { id: 's1', name: 'Sánguche de Mila Común', price: 6500, category: Category.Sanguches, shift: 'midday', imageUrls: [sangucheImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 's2', name: 'Sánguche de Mila Completo', price: 8000, category: Category.Sanguches, shift: 'midday', imageUrls: [sangucheImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 's3', name: 'Sánguche de Mila de Pollo Común', price: 5000, category: Category.Sanguches, shift: 'midday', imageUrls: [sangucheImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 's4', name: 'Sánguche de Mila de Pollo Completo', price: 7500, category: Category.Sanguches, shift: 'midday', imageUrls: [sangucheImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 's5', name: 'Sánguche de Miga', price: 6000, category: Category.Sanguches, shift: 'midday', imageUrls: [sangucheImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 's6', name: 'Sánguche de Miga Tostado', price: 6500, category: Category.Sanguches, shift: 'midday', imageUrls: [sangucheImage], description: '', ingredients: [], prepTime: 'N/A' },
        // Empanadas
        { id: 'e1', name: 'Empanadas Fritas de Carne', price: 8500, category: Category.Empanadas, shift: 'both', imageUrls: [empanadaImage], description: 'Precio por docena.', ingredients: [], prepTime: 'N/A' },

        // === NOCHE ===
        // Pizzas
        { id: 'pz1', name: 'Pizza de Mozzarella', price: 10500, category: Category.Pizzas, shift: 'night', imageUrls: [pizzaImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'pz2', name: 'Pizza de Jamón y Queso', price: 13000, category: Category.Pizzas, shift: 'night', imageUrls: [pizzaImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'pz3', name: 'Pizza Especial', price: 14500, category: Category.Pizzas, shift: 'night', imageUrls: [pizzaImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'pz4', name: 'Pizza Napolitana', price: 12000, category: Category.Pizzas, shift: 'night', imageUrls: [pizzaImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'pz5', name: 'Pizza de Anchoas', price: 15500, category: Category.Pizzas, shift: 'night', imageUrls: [pizzaImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'pz6', name: 'Pizza Fugazza', price: 12000, category: Category.Pizzas, shift: 'night', imageUrls: [pizzaImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'pz7', name: 'Pizza Calabresa', price: 15000, category: Category.Pizzas, shift: 'night', imageUrls: [pizzaImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'pz8', name: 'Pizza de Humita', price: 13000, category: Category.Pizzas, shift: 'night', imageUrls: [pizzaImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'pz9', name: 'Pizza de 4 Quesos', price: 15500, category: Category.Pizzas, shift: 'night', imageUrls: [pizzaImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'pz10', name: 'Pizza de Jamón y Morrones', price: 14000, category: Category.Pizzas, shift: 'night', imageUrls: [pizzaImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'pz11', name: 'Pizza Provenzal', price: 12500, category: Category.Pizzas, shift: 'night', imageUrls: [pizzaImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'pz12', name: 'Pizza Americana', price: 15500, category: Category.Pizzas, shift: 'night', imageUrls: [pizzaImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'pz13', name: 'Pizza de Panceta y Ajo', price: 13000, category: Category.Pizzas, shift: 'night', imageUrls: [pizzaImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'pz14', name: 'Pizza de Roquefort', price: 14500, category: Category.Pizzas, shift: 'night', imageUrls: [pizzaImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'pz15', name: 'Pizza de Palmitos', price: 15000, category: Category.Pizzas, shift: 'night', imageUrls: [pizzaImage], description: '', ingredients: [], prepTime: 'N/A' },
        // Lomitos (Sanguches)
        { id: 'l1', name: 'Lomo Común', price: 12000, category: Category.Sanguches, shift: 'night', imageUrls: [sangucheImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'l2', name: 'Lomo Completo', price: 16000, category: Category.Sanguches, shift: 'night', imageUrls: [sangucheImage], description: '', ingredients: [], prepTime: 'N/A' },
        // Hamburguesas
        { id: 'h1', name: 'Hamburguesa Común', price: 6000, category: Category.Hamburguesas, shift: 'night', imageUrls: [burgerImage], description: '', ingredients: [], prepTime: 'N/A' },
        { id: 'h2', name: 'Hamburguesa Completa', price: 8000, category: Category.Hamburguesas, shift: 'night', imageUrls: [burgerImage], description: '', ingredients: [], prepTime: 'N/A' },
        // Guarniciones
        { id: 'g1', name: 'Papas Fritas Porción', price: 5000, category: Category.Guarniciones, shift: 'night', imageUrls: [friesImage], description: '', ingredients: [], prepTime: 'N/A' },
      ];

      // --- COMPONENTS ---
      const StoreStatusBanner = ({ status }) => {
        if (!status || status.isOpen) return null;
        const { message } = status;
        return (
            <div className="flex-shrink-0 text-center py-2 px-4 text-sm font-semibold text-white bg-red-600">
                {message}
            </div>
        );
      };

      const Header = ({ cartItemCount, onCartClick, onAboutClick }) => {
        return (
          <header className="bg-brand-header sticky top-0 z-40 flex-shrink-0 shadow-md">
            <div className="container mx-auto px-4 py-2 flex items-center justify-between">
              <div className="w-10">
                <button onClick={onAboutClick} className="text-brand-text p-2 rounded-full hover:bg-black/10 transition-colors" aria-label="Sobre Nosotros">
                  <svg xmlns="http://www.w3.org/2000/svg" className="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth="2">
                    <path strokeLinecap="round" strokeLinejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                </button>
              </div>
              <img 
                src="https://ia902909.us.archive.org/18/items/rocola-logo-png-03/rocola%20logo%20png-03.png" 
                alt="La Rocola Logo" 
                className="h-14 w-auto" 
              />
              <div className="relative w-10">
                <button onClick={onCartClick} className="relative text-brand-text p-2 rounded-full hover:bg-black/10 transition-colors" aria-label={`Ver carrito de compras con ${cartItemCount} artículos`}>
                  <svg xmlns="http://www.w3.org/2000/svg" className="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth="2">
                    <path strokeLinecap="round" strokeLinejoin="round" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
                  </svg>
                  {cartItemCount > 0 && (
                    <span className="absolute -top-1 -right-1 flex h-5 w-5 items-center justify-center rounded-full bg-red-600 text-xs font-bold text-white">{cartItemCount}</span>
                  )}
                </button>
              </div>
            </div>
          </header>
        );
      };

      const ShiftNav = ({ activeShift, onShiftChange }) => {
        return (
          <div className="bg-brand-bg sticky top-[72px] z-30 shadow-md flex-shrink-0">
            <div className="container mx-auto p-2">
              <div className="flex w-full bg-black p-1 rounded-xl">
                <button
                  onClick={() => onShiftChange('midday')}
                  className={`w-1/2 text-center uppercase font-bold text-lg py-2 transition-colors duration-300 rounded-lg ${activeShift === 'midday' ? 'bg-brand-accent text-white' : 'text-gray-300 hover:bg-gray-800'}`}
                  aria-pressed={activeShift === 'midday'}
                >
                  Medio Día
                </button>
                <button
                  onClick={() => onShiftChange('night')}
                  className={`w-1/2 text-center uppercase font-bold text-lg py-2 transition-colors duration-300 rounded-lg ${activeShift === 'night' ? 'bg-brand-accent text-white' : 'text-gray-300 hover:bg-gray-800'}`}
                  aria-pressed={activeShift === 'night'}
                >
                  Noche
                </button>
              </div>
            </div>
          </div>
        );
      };

      const MenuItemCard = ({ item, onSelect, onPrepareAddToCart, isStoreOpen }) => {
        const handleAddClick = (e, size = 'full') => {
          e.stopPropagation();
          onPrepareAddToCart(item, size);
        };

        const isPizza = item.category === Category.Pizzas;
        const isEmpanada = item.category === Category.Empanadas;
        const hasSizes = isPizza || isEmpanada;

        return (
          <div 
            className="bg-brand-card rounded-lg shadow-md shadow-stone-400/20 hover:shadow-lg hover:shadow-brand-accent/20 transition-all duration-300 flex items-stretch cursor-pointer group overflow-hidden"
            onClick={() => onSelect(item)}
            role="button"
            aria-label={`Ver detalles de ${item.name}`}
          >
            <div className="w-1/3 flex-shrink-0">
              <img
                src={item.imageUrls[0]}
                alt={item.name}
                className="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
              />
            </div>
            <div className="p-3 sm:p-4 flex flex-col flex-grow w-2/3">
              <h3 className="text-md sm:text-lg font-bold text-brand-text mb-1">{item.name}</h3>
              <div className="flex justify-between items-center mt-auto">
                {item.price > 0 && <span className="text-md sm:text-lg font-bold text-brand-accent">{formatPrice(item.price)}</span>}
                
                {hasSizes ? (
                  <div className="flex items-center gap-2">
                    <button 
                      onClick={(e) => handleAddClick(e, 'half')} 
                      className="bg-brand-accent text-white hover:bg-orange-700 transition-colors shadow-md px-3 py-2 rounded-lg text-xs sm:text-sm font-bold disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-gray-500" 
                      aria-label={isPizza ? `Agregar media ${item.name} al carrito` : `Agregar media docena de ${item.name} al carrito`}
                      disabled={!isStoreOpen}
                    >
                      {isPizza ? 'Mitad' : 'Media'}
                    </button>
                    <button 
                      onClick={(e) => handleAddClick(e, 'full')} 
                      className="bg-brand-accent text-white hover:bg-orange-700 transition-colors shadow-md px-4 py-2 rounded-lg text-sm font-bold disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-gray-500" 
                      aria-label={isPizza ? `Agregar ${item.name} entera al carrito` : `Agregar una docena de ${item.name} al carrito`}
                      disabled={!isStoreOpen}
                    >
                      {isPizza ? 'Entera' : 'Docena'}
                    </button>
                  </div>
                ) : (
                  <button 
                    onClick={handleAddClick} 
                    className="bg-brand-accent text-white hover:bg-orange-700 transition-colors shadow-lg p-2 rounded-full disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-gray-500" 
                    aria-label={`Agregar ${item.name} al carrito`}
                    disabled={!isStoreOpen}
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                      <path fillRule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clipRule="evenodd" />
                    </svg>
                  </button>
                )}
              </div>
            </div>
          </div>
        );
      };
      
      const IconMap = {
        'Todo': (
          <img src="https://cdn-icons-png.freepik.com/512/9725/9725767.png" alt="Todo" className="w-full h-full object-contain" />
        ),
        'Promos': (
          <img src="https://cdn-icons-png.freepik.com/512/5507/5507512.png" alt="Promos" className="w-full h-full object-contain" />
        ),
        'Pizzas': (
          <img src="https://cdn-icons-png.flaticon.com/512/1404/1404945.png" alt="Pizzas" className="w-full h-full object-contain" />
        ),
        'Hamburguesas': (
          <img src="https://cdn-icons-png.flaticon.com/512/5787/5787016.png" alt="Hamburguesas" className="w-full h-full object-contain" />
        ),
        'Empanadas': (
          <img src="https://cdn-icons-png.flaticon.com/512/6002/6002264.png" alt="Empanadas" className="w-full h-full object-contain" />
        ),
        'Sánguches': (
          <img src="https://cdn-icons-png.flaticon.com/512/3574/3574451.png" alt="Sánguches" className="w-full h-full object-contain" />
        ),
        'Pastas': (
          <img src="https://cdn-icons-png.freepik.com/512/4465/4465494.png?uid=R3396507" alt="Pastas" className="w-full h-full object-contain" />
        ),
        'Comidas al Plato': (
          <img src="https://cdn-icons-png.flaticon.com/512/3480/3480823.png" alt="Comidas al Plato" className="w-full h-full object-contain" />
        ),
        'Guarniciones': (
            <img src="https://cdn-icons-png.flaticon.com/512/123/123300.png" alt="Guarniciones" className="w-full h-full object-contain" />
        ),
        'Bebidas': (
          <img src="https://cdn-icons-png.flaticon.com/512/1261/1261134.png" alt="Bebidas" className="w-full h-full object-contain" />
        ),
      };

      const CategoryNav = ({ categories, activeCategory, onCategorySelect }) => {
        const [isOpen, setIsOpen] = useState(false);
        const buttonRef = useRef(null);
        const dropdownRef = useRef(null);

        const handleSelect = (category) => {
          onCategorySelect(category);
          setIsOpen(false);
        };
        
        useEffect(() => {
          const handleClickOutside = (event) => {
            if (isOpen && dropdownRef.current && !dropdownRef.current.contains(event.target) && buttonRef.current && !buttonRef.current.contains(event.target)) {
              setIsOpen(false);
            }
          };
          document.addEventListener('mousedown', handleClickOutside);
          return () => document.removeEventListener('mousedown', handleClickOutside);
        }, [isOpen]);

        const activeIcon = IconMap[activeCategory] || IconMap['Todo'];

        return (
          <div className="relative w-full">
            <button
              ref={buttonRef}
              onClick={() => setIsOpen(!isOpen)}
              className="bg-brand-card text-brand-text font-semibold py-2 px-4 rounded-lg border border-stone-400/50 hover:border-brand-accent transition-colors duration-300 flex items-center justify-between shadow w-full text-base sm:text-lg"
              aria-haspopup="true"
              aria-expanded={isOpen}
            >
              <div className="flex items-center gap-3 min-w-0">
                <div className="w-7 h-7 rounded-full flex-shrink-0 bg-brand-accent/10 flex items-center justify-center p-1 text-brand-accent">
                  {activeIcon}
                </div>
                <span className="whitespace-nowrap">{activeCategory}</span>
              </div>
              <svg className={`w-5 h-5 text-brand-text-light transition-transform duration-300 flex-shrink-0 ml-3 ${isOpen ? 'rotate-180' : ''}`} fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 9l-7 7-7-7"></path></svg>
            </button>
            {isOpen && (
              <div
                ref={dropdownRef}
                className="absolute top-full mt-2 w-full z-40"
                aria-hidden={!isOpen}
              >
                <div className="bg-brand-card/95 backdrop-blur-sm shadow-xl rounded-lg p-4">
                  <div className="grid grid-cols-2 gap-3 sm:gap-4">
                    {categories.map(cat => (
                      <button
                        key={cat}
                        onClick={() => handleSelect(cat)}
                        className={`bg-white rounded-lg aspect-video transition-all duration-300 transform hover:-translate-y-1 shadow-md hover:shadow-xl hover:shadow-brand-accent/20 focus:outline-none focus:ring-4 focus:ring-brand-accent/50 flex flex-col items-center justify-center p-2 text-center group cursor-pointer ${
                          activeCategory === cat ? 'ring-4 ring-brand-accent' : ''
                        }`}
                        aria-label={`Seleccionar categoría ${cat}`}
                      >
                        <div className="w-8 h-8 sm:w-10 sm:h-10 text-brand-accent">
                            {IconMap[cat] || IconMap['Todo']}
                        </div>
                        <span className="text-sm sm:text-base font-bold mt-2 text-brand-text group-hover:text-brand-accent transition-colors">{cat}</span>
                      </button>
                    ))}
                  </div>
                </div>
              </div>
            )}
          </div>
        );
      };

      const ItemDetailView = ({ item, onClose, onAddToCart, isStoreOpen }) => {
        const [quantity, setQuantity] = useState(1);

        useEffect(() => {
            const handleEsc = (event) => {
                if (event.key === 'Escape') onClose();
            };
            window.addEventListener('keydown', handleEsc);
            return () => window.removeEventListener('keydown', handleEsc);
        }, [onClose]);
        
        useEffect(() => {
          if(item) {
            setQuantity(1); // Reset quantity when item changes
            document.body.style.overflow = 'hidden';
          } else {
            document.body.style.overflow = 'auto';
          }
          return () => document.body.style.overflow = 'auto';
        }, [item]);

        if (!item) return null;

        const handleAddToCart = () => {
          onAddToCart(item, quantity);
          onClose();
        };

        return (
          <div className={`fixed inset-0 bg-black/60 z-50 flex items-center justify-center transition-opacity duration-300 ${item ? 'opacity-100' : 'opacity-0 pointer-events-none'}`} onClick={onClose}>
            <div className={`bg-brand-bg rounded-lg shadow-xl w-full max-w-md h-full max-h-[90vh] flex flex-col transform transition-transform duration-300 ${item ? 'scale-100' : 'scale-95'}`} onClick={e => e.stopPropagation()}>
                <div className="relative w-full h-2/5 flex-shrink-0 bg-stone-200">
                  <img src={item.imageUrls[0]} alt={item.name} className="w-full h-full object-cover rounded-t-lg"/>
                   <button onClick={onClose} className="absolute top-4 right-4 bg-black/50 text-white rounded-full p-2 hover:bg-black/70 transition-colors" aria-label="Cerrar detalles">
                      <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" /></svg>
                  </button>
                </div>
                <div className="flex-grow overflow-y-auto no-scrollbar p-4 sm:p-6 space-y-4">
                    <div className="flex justify-between items-start">
                      <h2 className="text-2xl sm:text-3xl font-bold text-brand-accent flex-1 pr-4">{item.name}</h2>
                      {item.price > 0 && <p className="text-2xl sm:text-3xl font-bold text-brand-accent">{formatPrice(item.price)}</p>}
                    </div>
                    <p className="text-brand-text text-sm sm:text-base">{item.description}</p>
                    {item.ingredients && item.ingredients.length > 0 && (
                      <div>
                        <h4 className="font-semibold text-lg text-brand-text mb-2">Ingredientes:</h4>
                        <ul className="list-disc list-inside text-brand-text-light space-y-1 text-sm sm:text-base">
                          {item.ingredients.map((ing, index) => <li key={index}>{ing}</li>)}
                        </ul>
                      </div>
                    )}
                    {item.prepTime !== 'N/A' && <p className="text-sm text-brand-text-light mt-4">Tiempo de prep: <span className="font-medium text-brand-text">{item.prepTime}</span></p>}
                </div>
                <div className="flex-shrink-0 p-4 bg-brand-bg/80 backdrop-blur-sm border-t border-stone-300 rounded-b-lg">
                  <div className="flex items-center gap-4">
                    <div className="flex items-center justify-center gap-2 rounded-lg bg-brand-card p-2">
                      <button onClick={() => setQuantity(q => Math.max(1, q - 1))} className="text-brand-accent text-2xl font-bold w-8 h-8 rounded-md hover:bg-stone-300/50">-</button>
                      <span className="text-xl font-bold text-brand-text w-8 text-center">{quantity}</span>
                      <button onClick={() => setQuantity(q => q + 1)} className="text-brand-accent text-2xl font-bold w-8 h-8 rounded-md hover:bg-stone-300/50">+</button>
                    </div>
                    <button onClick={handleAddToCart} className="flex-1 bg-green-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-700 transition-colors duration-300 flex items-center justify-center gap-2 text-lg disabled:bg-red-600 disabled:cursor-not-allowed" disabled={!isStoreOpen}>
                      {isStoreOpen ? `Agregar ${formatPrice(item.price * quantity)}` : 'Cerrado'}
                    </button>
                  </div>
                </div>
              </div>
          </div>
        );
      };

      const ShoppingCartView = ({ isOpen, onClose, cart, onUpdateQuantity, onRemoveItem, onCheckout, subtotal, isStoreOpen }) => {
        useEffect(() => {
          if(isOpen) {
            document.body.style.overflow = 'hidden';
          } else {
            document.body.style.overflow = 'auto';
          }
          return () => document.body.style.overflow = 'auto';
        }, [isOpen]);

        return (
          <div className={`fixed inset-0 bg-black/60 z-50 transition-opacity duration-300 ${isOpen ? 'opacity-100' : 'opacity-0 pointer-events-none'}`} onClick={onClose}>
            <div className={`absolute right-0 top-0 h-full w-full max-w-sm bg-brand-bg flex flex-col shadow-2xl transform transition-transform duration-300 ${isOpen ? 'translate-x-0' : 'translate-x-full'}`} onClick={e => e.stopPropagation()}>
              <div className="flex items-center justify-between p-4 border-b border-stone-300">
                <h2 className="text-xl font-bold text-brand-accent">Mi Carrito</h2>
                <button onClick={onClose} className="p-2 rounded-full hover:bg-stone-200" aria-label="Cerrar carrito">
                  <svg className="w-6 h-6 text-brand-text" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
              </div>

              {cart.length === 0 ? (
                <div className="flex-grow flex flex-col items-center justify-center text-center p-4">
                  <p className="text-brand-text-light">Tu carrito está vacío<br/>Agregá productos para empezar a comprar.</p>
                </div>
              ) : (
                <div className="flex-grow overflow-y-auto p-4 space-y-4">
                  {cart.map(({ item, quantity }) => (
                    <div key={item.id} className="flex items-start gap-3 bg-brand-card p-3 rounded-lg shadow-sm">
                      <img src={item.imageUrls[0]} alt={item.name} className="w-20 h-20 rounded-md object-cover flex-shrink-0" />
                      <div className="flex-grow flex flex-col">
                        <div className="flex justify-between items-start">
                          <h4 className="font-bold text-brand-text pr-2">{item.name}</h4>
                          <p className="font-bold text-brand-text text-lg flex-shrink-0">{formatPrice(item.price * quantity)}</p>
                        </div>
                        <p className="text-sm text-brand-text-light">{formatPrice(item.price)} c/u</p>
                        <div className="flex justify-between items-center mt-auto pt-2">
                           <div className="flex items-center gap-2">
                             <button onClick={() => onUpdateQuantity(item.id, quantity - 1)} className="w-7 h-7 border border-stone-300 rounded-md text-brand-accent font-bold text-lg flex items-center justify-center hover:bg-stone-200 transition-colors">-</button>
                             <span className="w-8 text-center font-semibold text-lg">{quantity}</span>
                             <button onClick={() => onUpdateQuantity(item.id, quantity + 1)} className="w-7 h-7 border border-stone-300 rounded-md text-brand-accent font-bold text-lg flex items-center justify-center hover:bg-stone-200 transition-colors">+</button>
                           </div>
                           <button onClick={() => onRemoveItem(item.id)} className="text-red-500 hover:text-red-700" aria-label={`Quitar ${item.name} del carrito`}>
                             <svg className="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path fillRule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z" clipRule="evenodd" /></svg>
                           </button>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              )}
              
              {cart.length > 0 && (
                <div className="p-4 border-t border-stone-300 space-y-3">
                    {!isStoreOpen && <p className="text-sm text-red-600 font-semibold text-center pb-2">No se pueden realizar pedidos en este momento.</p>}
                    <div className="flex justify-between text-brand-text">
                        <span>Subtotal</span>
                        <span className="font-semibold">{formatPrice(subtotal)}</span>
                    </div>
                     <p className="text-xs text-brand-text-light text-center mt-2">El costo de envío dependerá de la distancia.</p>
                    <button onClick={onCheckout} className="w-full mt-2 bg-green-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-700 transition-colors duration-300 text-lg disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-gray-500" disabled={!isStoreOpen}>
                      Continuar Compra
                    </button>
                </div>
              )}
            </div>
          </div>
        );
      };

      const CheckoutView = ({ isOpen, onClose, subtotal, onConfirmOrder, isStoreOpen }) => {
        const [formData, setFormData] = useState({ name: '', address: '', phone: '' });
        const [deliveryMethod, setDeliveryMethod] = useState('pickup');

        const total = subtotal;
        
        useEffect(() => {
          if (isOpen) {
            document.body.style.overflow = 'hidden';
            setFormData({ name: '', address: '', phone: '' });
            setDeliveryMethod('pickup');
          } else {
            document.body.style.overflow = 'auto';
          }
          return () => document.body.style.overflow = 'auto';
        }, [isOpen]);

        const handleChange = (e) => {
          const { name, value } = e.target;
          setFormData(prev => ({ ...prev, [name]: value }));
        };

        const handleSubmit = (e) => {
          e.preventDefault();
          const orderDetails = {
            customer: formData,
            deliveryMethod: deliveryMethod,
            total: total,
          };
          onConfirmOrder(orderDetails);
        };
        
        if (!isOpen) return null;

        const isFormInvalid = !formData.name.trim() || !formData.phone.trim() || (deliveryMethod === 'delivery' && !formData.address.trim());

        return (
          <div className="fixed inset-0 bg-brand-bg z-[60] flex flex-col" role="dialog" aria-modal="true">
            <div className="flex-shrink-0 p-4 border-b border-stone-300 flex items-center">
               <button onClick={onClose} className="p-2 rounded-full hover:bg-stone-200 mr-4" aria-label="Volver al carrito">
                  <svg className="w-6 h-6 text-brand-text" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M15 19l-7-7 7-7"></path></svg>
               </button>
               <h2 className="text-xl font-bold text-brand-accent">Finalizar Compra</h2>
            </div>
            <div className="flex-grow overflow-y-auto p-4 sm:p-6">
              <form id="checkout-form" onSubmit={handleSubmit} className="space-y-6">
                <div>
                  <h3 className="text-lg font-semibold text-brand-text mb-4">Tus Datos</h3>
                  <div className="space-y-4">
                    <div>
                      <label htmlFor="name" className="block text-sm font-medium text-brand-text-light mb-1">Nombre Completo</label>
                      <input type="text" name="name" id="name" required className="w-full px-3 py-2 bg-brand-card border border-stone-300 rounded-md focus:ring-brand-accent focus:border-brand-accent" onChange={handleChange} value={formData.name} />
                    </div>
                    <div>
                      <label htmlFor="phone" className="block text-sm font-medium text-brand-text-light mb-1">Teléfono</label>
                      <input type="tel" name="phone" id="phone" required className="w-full px-3 py-2 bg-brand-card border border-stone-300 rounded-md focus:ring-brand-accent focus:border-brand-accent" onChange={handleChange} value={formData.phone} />
                    </div>
                  </div>
                </div>

                <div>
                  <h3 className="text-lg font-semibold text-brand-text mb-4">Método de Entrega</h3>
                  <div className="space-y-3">
                    <label className={`flex items-center p-3 bg-brand-card rounded-lg border-2 transition-all cursor-pointer ${deliveryMethod === 'pickup' ? 'border-brand-accent shadow-md' : 'border-transparent hover:border-stone-400'}`}>
                      <input type="radio" name="deliveryMethod" value="pickup" checked={deliveryMethod === 'pickup'} onChange={(e) => setDeliveryMethod(e.target.value)} className="w-5 h-5 text-brand-accent focus:ring-brand-accent focus:ring-2"/>
                      <div className="ml-3">
                        <span className="font-semibold text-brand-text">Retiro en local</span>
                        <p className="text-sm text-brand-text-light">Sin costo adicional.</p>
                      </div>
                    </label>
                    <label className={`flex items-center p-3 bg-brand-card rounded-lg border-2 transition-all cursor-pointer ${deliveryMethod === 'delivery' ? 'border-brand-accent shadow-md' : 'border-transparent hover:border-stone-400'}`}>
                      <input type="radio" name="deliveryMethod" value="delivery" checked={deliveryMethod === 'delivery'} onChange={(e) => setDeliveryMethod(e.target.value)} className="w-5 h-5 text-brand-accent focus:ring-brand-accent focus:ring-2"/>
                      <div className="ml-3">
                        <span className="font-semibold text-brand-text">Envío a domicilio</span>
                        <p className="text-sm text-brand-text-light">El costo de envío dependerá de la distancia.</p>
                      </div>
                    </label>
                  </div>
                </div>

                {deliveryMethod === 'delivery' && (
                  <div className="transition-all">
                    <label htmlFor="address" className="block text-sm font-medium text-brand-text-light mb-1">Dirección de Envío</label>
                    <input type="text" name="address" id="address" required={deliveryMethod === 'delivery'} className="w-full px-3 py-2 bg-brand-card border border-stone-300 rounded-md focus:ring-brand-accent focus:border-brand-accent" onChange={handleChange} value={formData.address} placeholder="Calle, número, barrio..."/>
                  </div>
                )}
              </form>
            </div>
            <div className="flex-shrink-0 p-4 bg-brand-bg/80 backdrop-blur-sm border-t border-stone-300">
                <div className="flex justify-between items-center mb-4 text-xl">
                  <span className="font-semibold text-brand-text">Total a pagar:</span>
                  <span className="font-bold text-brand-accent">{formatPrice(total)}</span>
                </div>
                <button type="submit" form="checkout-form" className="w-full bg-green-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-600 transition-colors duration-300 flex items-center justify-center gap-2 text-lg disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-red-600" disabled={isFormInvalid || !isStoreOpen}>
                    {isStoreOpen && <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.894 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.886-.001 2.267.651 4.39 1.88 6.166l-1.29 4.721 4.793-1.267zM8.348 7.119c-.095-.334-.447-.404-.638-.41a.53.53 0 00-.546.54c0 1.563 1.258 3.12 1.43 3.31.171.191 2.392 3.844 5.86 5.166 2.949 1.111 3.585 1.023 4.104.975.597-.055 1.815-.742 2.067-1.44.252-.699.252-1.293.176-1.44-.076-.147-.27-.223-.546-.381-.275-.156-1.815-.891-2.096-1.001-.28-.11-.481-.157-.678.156-.196.313-.791.996-.97 1.206-.181.21-.362.235-.638.077-.276-.157-1.16-0.428-2.204-1.359-1.603-1.026-2.69-2.277-2.887-2.67-.196-.394-.012-.611.139-.757.135-.131.299-.219.423-.339.124-.121.187-.21.28-.352.093-.142.049-.26-.004-.374-.053-.114-.482-1.155-.658-1.587z"/></svg>}
                    {isStoreOpen ? 'Realizar Pedido por WhatsApp' : 'Cerrado'}
                </button>
            </div>
          </div>
        );
      };
      
      const AboutUsView = ({ isOpen, onClose }) => {
        useEffect(() => {
          if(isOpen) {
            document.body.style.overflow = 'hidden';
          } else {
            document.body.style.overflow = 'auto';
          }
          return () => document.body.style.overflow = 'auto';
        }, [isOpen]);

        if (!isOpen) return null;

        return (
          <div className={`fixed inset-0 bg-black/60 z-50 flex items-center justify-center transition-opacity duration-300 ${isOpen ? 'opacity-100' : 'opacity-0 pointer-events-none'}`} onClick={onClose}  role="dialog" aria-modal="true">
            <div className={`bg-brand-bg rounded-lg shadow-xl w-full max-w-md m-4 p-6 flex flex-col transform transition-transform duration-300 relative ${isOpen ? 'scale-100' : 'scale-95'}`} onClick={e => e.stopPropagation()}>
              <button onClick={onClose} className="absolute top-4 right-4 p-2 rounded-full hover:bg-stone-200/80 transition-colors" aria-label="Cerrar">
                  <svg className="w-6 h-6 text-brand-text" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" /></svg>
              </button>
              
              <div className="text-center mb-6">
                <img 
                  src="https://ia902909.us.archive.org/18/items/rocola-logo-png-03/rocola%20logo%20png-03.png" 
                  alt="La Rocola Logo" 
                  className="h-20 w-auto mx-auto mb-4" 
                />
                <h2 className="text-2xl font-bold text-black uppercase">Sobre Nosotros</h2>
              </div>
              
              <div className="flex-grow space-y-2 text-brand-text text-center">
                <p className="text-lg">
                  Somos La Rocola, tu lugar de confianza para las mejores pizzas, hamburguesas y más.
                </p>
                <p className="text-lg">
                  También contamos con almuerzos caseros al medio día.
                </p>
                <p className="text-lg">
                  ¡Te esperamos!
                </p>
              </div>

              <div className="mt-6 pt-6 border-t border-stone-300 space-y-3">
                <a href="https://maps.app.goo.gl/Wyzyc7YMFxGybe8G6" target="_blank" rel="noopener noreferrer" className="w-full bg-brand-accent text-white font-bold py-3 px-4 rounded-lg hover:bg-orange-700 transition-colors duration-300 flex items-center justify-center gap-2 text-lg">
                  <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth="2"><path strokeLinecap="round" strokeLinejoin="round" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" /><path strokeLinecap="round" strokeLinejoin="round" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
                  Calle 14 y 5 Centro
                </a>
                <a href="https://wa.me/5493644921028" target="_blank" rel="noopener noreferrer" className="w-full bg-green-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-600 transition-colors duration-300 flex items-center justify-center gap-2 text-lg">
                  <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.894 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.886-.001 2.267.651 4.39 1.88 6.166l-1.29 4.721 4.793-1.267zM8.348 7.119c-.095-.334-.447-.404-.638-.41a.53.53 0 00-.546.54c0 1.563 1.258 3.12 1.43 3.31.171.191 2.392 3.844 5.86 5.166 2.949 1.111 3.585 1.023 4.104.975.597-.055 1.815-.742 2.067-1.44.252-.699.252-1.293.176-1.44-.076-.147-.27-.223-.546-.381-.275-.156-1.815-.891-2.096-1.001-.28-.11-.481-.157-.678.156-.196.313-.791.996-.97 1.206-.181.21-.362.235-.638.077-.276-.157-1.16-0.428-2.204-1.359-1.603-1.026-2.69-2.277-2.887-2.67-.196-.394-.012-.611.139-.757.135-.131.299-.219.423-.339.124-.121.187-.21.28-.352.093-.142.049-.26-.004-.374-.053-.114-.482-1.155-.658-1.587z"/></svg>
                  Habla con Nosotros
                </a>
                <a href="tel:3644921028" className="w-full bg-brand-accent text-white font-bold py-3 px-4 rounded-lg hover:bg-orange-700 transition-colors duration-300 flex items-center justify-center gap-2 text-lg">
                  <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth="2"><path strokeLinecap="round" strokeLinejoin="round" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" /></svg>
                  Llamar
                </a>
              </div>
              <div className="text-center text-xs text-brand-text-light mt-6">
                <p>2025 - Tienda Guah! - 3644921028</p>
                <p>Todos los derechos reservados</p>
              </div>
            </div>
          </div>
        );
      };

      const CartBanner = ({ cartItemCount, subtotal, onClick }) => {
        return (
          <div className="fixed bottom-0 left-0 right-0 w-full max-w-md mx-auto p-4 z-40 pointer-events-none animate-slide-in-from-bottom">
              <button 
                className="bg-green-600 text-white rounded-lg shadow-2xl w-full p-3 flex items-center justify-between pointer-events-auto transform transition-transform duration-300 hover:scale-[1.02] active:scale-100 cursor-pointer focus:outline-none focus:ring-4 focus:ring-green-400"
                onClick={onClick}
                aria-label={`Ver pedido. ${cartItemCount} artículos, total ${formatPrice(subtotal)}`}
              >
                  <div className="flex items-center gap-3">
                      <div className="relative">
                          <svg xmlns="http://www.w3.org/2000/svg" className="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth="2">
                              <path strokeLinecap="round" strokeLinejoin="round" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
                          </svg>
                          <span className="absolute -top-2 -right-2 flex h-5 w-5 items-center justify-center rounded-full bg-red-600 text-xs font-bold">{cartItemCount}</span>
                      </div>
                      <span className="text-lg font-bold">Ver pedido</span>
                  </div>
                  <span className="text-lg font-bold">{formatPrice(subtotal)}</span>
              </button>
          </div>
        );
      };

      const OrderSuccessView = ({ isOpen }) => {
        if (!isOpen) return null;
        return (
          <div className="fixed inset-0 bg-black/70 z-[70] flex items-center justify-center p-4">
            <div className="bg-brand-card rounded-xl p-8 text-center flex flex-col items-center shadow-2xl">
              <div className="w-20 h-20 bg-green-500 rounded-full flex items-center justify-center mb-6">
                <svg className="w-12 h-12 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M5 13l4 4L19 7"></path></svg>
              </div>
              <h2 className="text-2xl font-bold text-brand-accent mb-2">¡Pedido Enviado!</h2>
              <p className="text-brand-text-light max-w-xs">Tu pedido fue enviado por WhatsApp. ¡Pronto te confirmaremos y lo prepararemos!</p>
            </div>
          </div>
        );
      }
      
      const AddToCartModal = ({ itemInfo, onClose, onConfirm, isStoreOpen }) => {
        const [quantity, setQuantity] = useState(1);

        useEffect(() => {
          if (itemInfo) {
            setQuantity(1);
            document.body.style.overflow = 'hidden';
            const handleEsc = (event) => {
                if (event.key === 'Escape') onClose();
            };
            window.addEventListener('keydown', handleEsc);
            return () => window.removeEventListener('keydown', handleEsc);
          } else {
             document.body.style.overflow = 'auto';
          }
        }, [itemInfo, onClose]);

        if (!itemInfo) return null;

        const { item, size } = itemInfo;

        const isHalf = size === 'half';
        const pricePerUnit = isHalf 
          ? (item.id === 'pz1' ? 6000 : (item.category === Category.Empanadas ? 4500 : item.price / 2))
          : item.price;
        
        const isEmpanada = item.category === Category.Empanadas;
        const displayName = isHalf 
          ? (isEmpanada ? `Media Docena de ${item.name}` : `1/2 ${item.name}`)
          : item.name;

        const handleConfirmClick = () => {
          onConfirm(itemInfo, isHalf ? 1 : quantity);
        };

        return (
          <div className="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 transition-opacity duration-300" onClick={onClose}>
            <div className="bg-brand-card rounded-lg shadow-xl w-full max-w-xs p-6 flex flex-col space-y-4 transform transition-transform duration-300" onClick={e => e.stopPropagation()}>
              <div>
                <h2 className="text-lg font-bold text-brand-text">Vas a agregar:</h2>
                <p className="text-xl font-semibold text-brand-accent -mt-1">{displayName}</p>
              </div>
              <p className="text-lg font-bold text-brand-text">Costo: <span className="text-brand-accent">{formatPrice(pricePerUnit)}</span></p>
              
              {!isHalf && (
                <div className={`flex items-center justify-center py-2 ${isEmpanada ? 'flex-col gap-1' : 'gap-4'}`}>
                  <div className="flex items-center justify-center gap-4">
                    <button onClick={() => setQuantity(q => Math.max(1, q - 1))} className="text-brand-accent text-3xl font-bold w-12 h-12 rounded-full bg-stone-200 hover:bg-stone-300/80 transition-colors flex items-center justify-center">-</button>
                    <span className="text-2xl font-bold text-brand-text w-12 text-center">{quantity}</span>
                    <button onClick={() => setQuantity(q => q + 1)} className="text-brand-accent text-3xl font-bold w-12 h-12 rounded-full bg-stone-200 hover:bg-stone-300/80 transition-colors flex items-center justify-center">+</button>
                  </div>
                  {isEmpanada && (
                    <span className="text-md font-semibold text-brand-text-light uppercase tracking-wider">{quantity > 1 ? 'Docenas' : 'Docena'}</span>
                  )}
                </div>
              )}

              <div className="flex flex-col gap-3 pt-2">
                 <button onClick={handleConfirmClick} className="w-full bg-green-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-700 transition-colors duration-300 flex items-center justify-center gap-2 text-lg disabled:bg-red-600 disabled:cursor-not-allowed" disabled={!isStoreOpen}>
                  {isStoreOpen ? `Agregar (${formatPrice(pricePerUnit * (isHalf ? 1 : quantity))})` : 'Cerrado'}
                </button>
                <button onClick={onClose} className="w-full bg-stone-400 text-white font-bold py-2 px-4 rounded-lg hover:bg-stone-500 transition-colors duration-300 text-base">
                  Cancelar
                </button>
              </div>
            </div>
          </div>
        );
      };

      const MenuPage = ({ onItemSelect, onPrepareAddToCart, activeShift, isStoreOpen }) => {
        const [selectedCategory, setSelectedCategory] = useState('Todo');

        const nightCategories = [
          Category.Pizzas,
          Category.Hamburguesas,
          Category.Sanguches,
          Category.Empanadas,
          Category.Guarniciones,
          Category.Bebidas,
        ];
        
        const middayCategories = [
            Category.Pastas,
            Category.ComidasAlPlato,
            Category.Sanguches,
            Category.Empanadas,
            Category.Bebidas
        ];

        const orderedCategories = useMemo(() => {
            return activeShift === 'night' ? nightCategories : middayCategories;
        }, [activeShift]);
        
        const navCategories = useMemo(() => ['Todo', ...orderedCategories], [orderedCategories]);
        
        useEffect(() => {
            if (!navCategories.includes(selectedCategory)) {
                setSelectedCategory('Todo');
            }
        }, [navCategories, selectedCategory]);

        const filteredMenuItems = useMemo(() => {
            return menuItems.filter(item => item.shift === activeShift || item.shift === 'both');
        }, [activeShift]);

        return (
          <div className="relative">
            <div className="sticky top-0 bg-brand-bg/90 backdrop-blur-sm z-30 shadow-md shadow-stone-400/20">
              <div className="container mx-auto px-4 py-3">
                <CategoryNav
                  categories={navCategories}
                  activeCategory={selectedCategory}
                  onCategorySelect={setSelectedCategory}
                />
              </div>
            </div>

            <div className="p-2 sm:p-4 space-y-8 mt-4">
              {filteredMenuItems.length === 0 ? (
                <div className="text-center py-10">
                  <p className="text-brand-text-light">No hay productos disponibles en este turno.</p>
                </div>
              ) : selectedCategory === 'Todo' ? (
                orderedCategories.map(category => {
                  const categoryItems = filteredMenuItems.filter(item => item.category === category);
                  if (categoryItems.length === 0) return null;
                  return (
                    <div key={category}>
                      <div className="bg-brand-card rounded-lg py-2 px-4 mb-4 shadow-md flex items-center gap-3">
                        <div className="w-9 h-9 flex-shrink-0 p-1">
                            {IconMap[category]}
                        </div>
                        <h2 className="text-xl font-bold text-red-600 drop-shadow-[0_1px_1px_rgba(0,0,0,0.15)]">{category}</h2>
                      </div>
                      <div className="space-y-4">
                        {categoryItems.map(item => (
                            <MenuItemCard key={item.id} item={item} onSelect={onItemSelect} onPrepareAddToCart={onPrepareAddToCart} isStoreOpen={isStoreOpen} />
                        ))}
                      </div>
                    </div>
                  )
                })
              ) : (
                <div className="space-y-4">
                  {filteredMenuItems
                    .filter(item => item.category === selectedCategory)
                    .map(item => (
                      <MenuItemCard key={item.id} item={item} onSelect={onItemSelect} onPrepareAddToCart={onPrepareAddToCart} isStoreOpen={isStoreOpen}/>
                  ))}
                </div>
              )}
            </div>
          </div>
        );
      };


      // --- MAIN APP ---
      const App = () => {
        const [selectedItem, setSelectedItem] = useState(null);
        const [cart, setCart] = useState([]);
        const [isCartOpen, setIsCartOpen] = useState(false);
        const [isCheckoutOpen, setIsCheckoutOpen] = useState(false);
        const [isOrderSuccess, setIsOrderSuccess] = useState(false);
        const [isAboutOpen, setIsAboutOpen] = useState(false);
        const [itemToAdd, setItemToAdd] = useState(null);
        const [activeShift, setActiveShift] = useState('night');
        const [storeStatus, setStoreStatus] = useState(getStoreStatus(activeShift));

        useEffect(() => {
            const updateStatus = () => {
                setStoreStatus(getStoreStatus(activeShift));
            };
            updateStatus(); // Initial check
            const intervalId = setInterval(updateStatus, 60000); // Check every minute
            return () => clearInterval(intervalId);
        }, [activeShift]);

        const handleItemSelect = (item) => setSelectedItem(item);
        const handleCloseDetail = () => setSelectedItem(null);

        const handlePrepareAddToCart = (item, size = 'full') => {
          setSelectedItem(null);
          setItemToAdd({ item, size });
        };

        const handleConfirmAddToCart = (itemInfo, quantity) => {
          addToCart(itemInfo.item, quantity, itemInfo.size);
          setItemToAdd(null);
        };

        const addToCart = (item, quantity = 1, size = 'full') => {
          const isHalf = size === 'half';
          const cartItemId = isHalf ? `${item.id}_half` : item.id;
          const cartItemPrice = isHalf 
            ? (item.id === 'pz1' ? 6000 : (item.category === Category.Empanadas ? 4500 : item.price / 2)) 
            : item.price;
          
          let cartItemName = item.name;
          if (isHalf) {
            if (item.category === Category.Empanadas) {
                cartItemName = `Media Docena de ${item.name}`;
            } else { // For pizzas
                cartItemName = `1/2 ${item.name}`;
            }
          }

          const itemForCart = { 
            ...item, 
            id: cartItemId, 
            name: cartItemName, 
            price: cartItemPrice 
          };

          setCart(currentCart => {
            const existingItem = currentCart.find(i => i.item.id === cartItemId);
            if (existingItem) {
              return currentCart.map(i => 
                i.item.id === cartItemId 
                  ? { ...i, quantity: i.quantity + quantity } 
                  : i
              );
            }
            return [...currentCart, { item: itemForCart, quantity }];
          });
        };

        const updateCartQuantity = (itemId, newQuantity) => {
          if (newQuantity <= 0) {
            removeFromCart(itemId);
            return;
          }
          setCart(cart => cart.map(i => i.item.id === itemId ? { ...i, quantity: newQuantity } : i));
        };

        const removeFromCart = (itemId) => {
          setCart(cart => cart.filter(i => i.item.id !== itemId));
        };
        
        const handleCheckout = () => {
          setIsCartOpen(false);
          setIsCheckoutOpen(true);
        };
        
        const cartItemCount = useMemo(() => cart.reduce((count, i) => count + i.quantity, 0), [cart]);
        const cartSubtotal = useMemo(() => cart.reduce((total, i) => total + (i.item.price * i.quantity), 0), [cart]);

        const handleConfirmOrder = (orderData) => {
          const { customer, deliveryMethod, total } = orderData;
          const { name, phone, address } = customer;

          let message = `*Nuevo pedido de la APP*\n\n`;
          message += `*Turno: ${activeShift === 'midday' ? 'Medio Día' : 'Noche'}*\n\n`;
          message += `${name}\n`;
          message += `${phone}\n\n`;

          // --- Process cart for WhatsApp message ---
          const processedCart = [];
          const halfPortions = {}; // key: full item id, value: quantity of halves

          // Separate half portions and other items
          cart.forEach(cartItem => {
              if (cartItem.item.id.includes('_half')) {
                  const fullItemId = cartItem.item.id.replace('_half', '');
                  halfPortions[fullItemId] = (halfPortions[fullItemId] || 0) + cartItem.quantity;
              } else {
                  processedCart.push(JSON.parse(JSON.stringify(cartItem))); // Deep copy to avoid mutation
              }
          });

          // Consolidate half portions
          for (const fullItemId in halfPortions) {
              const totalHalves = halfPortions[fullItemId];
              const fullItemsCount = Math.floor(totalHalves / 2);
              const remainingHalves = totalHalves % 2;
              
              const originalFullItem = menuItems.find(mi => mi.id === fullItemId);
              if (!originalFullItem) continue;

              if (fullItemsCount > 0) {
                  const existingFullItem = processedCart.find(i => i.item.id === fullItemId);
                  if (existingFullItem) {
                      existingFullItem.quantity += fullItemsCount;
                  } else {
                      processedCart.push({ item: originalFullItem, quantity: fullItemsCount });
                  }
              }
              
              if (remainingHalves > 0) {
                  const halfPortionPrice = originalFullItem.id === 'pz1' ? 6000 : (originalFullItem.category === Category.Empanadas ? 4500 : originalFullItem.price / 2);
                  
                  let halfPortionName = `1/2 ${originalFullItem.name}`; // Default for pizza
                  if (originalFullItem.category === Category.Empanadas) {
                      halfPortionName = `Media Docena de ${originalFullItem.name}`;
                  }

                  const halfPortionItem = { 
                      ...originalFullItem, 
                      id: `${fullItemId}_half`, 
                      name: halfPortionName, 
                      price: halfPortionPrice
                  };
                  processedCart.push({ item: halfPortionItem, quantity: remainingHalves });
              }
          }
        
          // Generate message lines from processed cart
          processedCart.forEach(({ item, quantity }) => {
              const isEmpanada = item.category === Category.Empanadas;
              if (item.id.includes('_half')) {
                  if (isEmpanada) {
                      const baseName = item.name.replace('Media Docena de ', '');
                      message += `*1/2 Doc - ${baseName} - ${formatPrice(item.price)}*\n`;
                  } else {
                      message += `*${item.name} - ${formatPrice(item.price)}*\n`;
                  }
              } else {
                  if (isEmpanada) {
                      message += `*${quantity} Doc - ${item.name} - ${formatPrice(item.price * quantity)}*\n`;
                  } else {
                      message += `*${quantity} - ${item.name} - ${formatPrice(item.price * quantity)}*\n`;
                  }
              }
          });
          // --- End of cart processing ---

          message += `\n`;

          message += `Subtotal ${formatPrice(cartSubtotal)}\n\n`;

          if (deliveryMethod === 'delivery') {
            message += `*Método de entrega:* Envío a domicilio\n`;
            message += `*Dirección:* ${address}\n\n`;
          } else {
            message += `*Método de entrega:* Retira en el local\n\n`;
          }

          const totalLabel = deliveryMethod === 'delivery' ? 'TOTAL DEL PEDIDO (sin envío)' : 'TOTAL DEL PEDIDO';
          message += `*${totalLabel}:* *${formatPrice(total)}*`;

          const phoneNumber = "5493644921028";
          const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;

          window.open(whatsappUrl, '_blank');
          
          setIsCheckoutOpen(false);
          setCart([]);
          setIsOrderSuccess(true);
          setTimeout(() => setIsOrderSuccess(false), 5000);
        };


        return (
          <div className="w-full max-w-md mx-auto h-screen max-h-screen overflow-hidden bg-brand-bg text-brand-text font-sans antialiased flex flex-col relative shadow-2xl shadow-stone-800/50">
            <Header 
              cartItemCount={cartItemCount} 
              onCartClick={() => setIsCartOpen(true)} 
              onAboutClick={() => setIsAboutOpen(true)}
            />
            <ShiftNav activeShift={activeShift} onShiftChange={setActiveShift} />
            <StoreStatusBanner status={storeStatus} />
            <main className="flex-grow overflow-y-auto main-scroll-container no-scrollbar pb-24">
              <MenuPage 
                onItemSelect={handleItemSelect} 
                onPrepareAddToCart={handlePrepareAddToCart}
                activeShift={activeShift}
                isStoreOpen={storeStatus.isOpen}
              />
            </main>
            {cart.length > 0 && !isCartOpen && !isCheckoutOpen && !selectedItem && !itemToAdd && !isAboutOpen && (
                <CartBanner 
                    cartItemCount={cartItemCount}
                    subtotal={cartSubtotal}
                    onClick={() => setIsCartOpen(true)}
                />
            )}
            <ItemDetailView 
              item={selectedItem} 
              onClose={handleCloseDetail} 
              onAddToCart={addToCart} 
              isStoreOpen={storeStatus.isOpen}
            />
            <ShoppingCartView
              isOpen={isCartOpen}
              onClose={() => setIsCartOpen(false)}
              cart={cart}
              onUpdateQuantity={updateCartQuantity}
              onRemoveItem={removeFromCart}
              onCheckout={handleCheckout}
              subtotal={cartSubtotal}
              isStoreOpen={storeStatus.isOpen}
            />
            <CheckoutView
              isOpen={isCheckoutOpen}
              onClose={() => setIsCheckoutOpen(false)}
              subtotal={cartSubtotal}
              onConfirmOrder={handleConfirmOrder}
              isStoreOpen={storeStatus.isOpen}
            />
            <AboutUsView 
              isOpen={isAboutOpen}
              onClose={() => setIsAboutOpen(false)}
            />
            <AddToCartModal 
              itemInfo={itemToAdd}
              onClose={() => setItemToAdd(null)}
              onConfirm={handleConfirmAddToCart}
              isStoreOpen={storeStatus.isOpen}
            />
            <OrderSuccessView isOpen={isOrderSuccess} />
          </div>
        );
      };

      // --- RENDER ---
      const rootElement = document.getElementById('root');
      if (!rootElement) {
        throw new Error("Could not find root element to mount to");
      }
      const root = ReactDOM.createRoot(rootElement);
      root.render(<App />);
    </script>
  </body>
</html>
